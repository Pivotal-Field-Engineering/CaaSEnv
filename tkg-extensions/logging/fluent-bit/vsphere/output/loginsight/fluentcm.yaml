apiVersion: v1
data:
  cluster-name-filter.conf: |2

    [FILTER]
        Name record_modifier
        Match *
        Record cluster_name mc1
  filter-kubernetes.conf: |
    [FILTER]
        Name                kubernetes
        Match               kube.*
        Kube_URL            https://kubernetes.default.svc.cluster.local:443
        Merge_Log           On
        K8S-Logging.Parser  On
  filters.conf: |
    @INCLUDE filter-kubernetes.conf
    @INCLUDE cluster-name-filter.conf
  fluent-bit.conf: |
    [SERVICE]
        Flush         1
        Log_Level     warning
        Daemon        off
        Parsers_File  parsers.conf
        HTTP_Server   On
        HTTP_Listen   0.0.0.0
        HTTP_Port     2020

    @INCLUDE inputs.conf
    @INCLUDE filters.conf
    @INCLUDE outputs.conf
  input-forward.conf: |
    [INPUT]
        Name forward
        Port 24225
        Listen localhost
  input-kubernetes.conf: |
    [INPUT]
        Name              tail
        Tag               kube.*
        Path              /var/log/containers/*.log
        Parser            docker
        DB                /var/log/flb_kube.db
        Mem_Buf_Limit     5MB
        Skip_Long_Lines   On
        Refresh_Interval  10
  inputs.conf: |
    @INCLUDE input-kubernetes.conf
    @INCLUDE input-forward.conf
  output-file.conf: |
    [OUTPUT]
        Name file
        Match *
        Path /tmp/output.txt
  output-null.conf: |
    [OUTPUT]
        Name null
  outputs.conf: |2

    [OUTPUT]
        Name syslog
        Match *
        InstanceName insight
        Addr syslog.ragazzilab.com:514
        Cluster true
        TLSConfig {}
  parsers.conf: |
    [PARSER]
        Name   json
        Format json
        Time_Key time
        Time_Format %d/%b/%Y:%H:%M:%S %z

    [PARSER]
        Name        docker
        Format      json
        Time_Key    time
        Time_Format %Y-%m-%dT%H:%M:%S.%L
        Time_Keep   On
        # Command      |  Decoder | Field | Optional Action
        # =============|==================|=================
        Decode_Field_As   escaped    log
kind: ConfigMap
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","data":{"cluster-name-filter.conf":"","filter-kubernetes.conf":"[FILTER]\n    Name                kubernetes\n    Match               kube.*\n    Kube_URL            https://kubernetes.default.svc.cluster.local:443\n    Merge_Log           On\n    K8S-Logging.Parser  On\n","filters.conf":"@INCLUDE filter-kubernetes.conf\n@INCLUDE cluster-name-filter.conf\n","fluent-bit.conf":"[SERVICE]\n    Flush         1\n    Log_Level     warning\n    Daemon        off\n    Parsers_File  parsers.conf\n    HTTP_Server   On\n    HTTP_Listen   0.0.0.0\n    HTTP_Port     2020\n\n@INCLUDE inputs.conf\n@INCLUDE filters.conf\n@INCLUDE outputs.conf\n","input-forward.conf":"[INPUT]\n    Name forward\n    Port 24225\n    Listen localhost\n","input-kubernetes.conf":"[INPUT]\n    Name              tail\n    Tag               kube.*\n    Path              /var/log/containers/*.log\n    Parser            docker\n    DB                /var/log/flb_kube.db\n    Mem_Buf_Limit     5MB\n    Skip_Long_Lines   On\n    Refresh_Interval  10\n","inputs.conf":"@INCLUDE input-kubernetes.conf\n@INCLUDE input-forward.conf\n","output-file.conf":"[OUTPUT]\n    Name file\n    Match *\n    Path /tmp/output.txt\n","output-null.conf":"[OUTPUT]\n    Name null\n","outputs.conf":"@INCLUDE output-null.conf\n","parsers.conf":"[PARSER]\n    Name   json\n    Format json\n    Time_Key time\n    Time_Format %d/%b/%Y:%H:%M:%S %z\n\n[PARSER]\n    Name        docker\n    Format      json\n    Time_Key    time\n    Time_Format %Y-%m-%dT%H:%M:%S.%L\n    Time_Keep   On\n    # Command      |  Decoder | Field | Optional Action\n    # =============|==================|=================\n    Decode_Field_As   escaped    log\n"},"kind":"ConfigMap","metadata":{"annotations":{},"labels":{"app":"fluent-bit","logs":"true","safeToDelete":"true"},"name":"fluent-bit","namespace":"pks-system"}}
  creationTimestamp: "2020-02-10T16:29:12Z"
  labels:
    app: fluent-bit
    logs: "true"
    safeToDelete: "true"
  name: fluent-bit
  namespace: pks-system
  resourceVersion: "8200057"
  selfLink: /api/v1/namespaces/pks-system/configmaps/fluent-bit
  uid: 511e8e8f-cad8-4f37-b7e6-80d57cee354b
